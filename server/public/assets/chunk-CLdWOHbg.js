import{r as o,a as t,j as e,A as W,F as M,B as X,C as Z,d as q,L as G,e as H,f as J,p as Q,g as Y,h as ee,P as te}from"./index-CYQNl7tF.js";import{M as ae,a as se,g as T,b as re,r as ne}from"./chunk-DS_Lf4so.js";import{a as B}from"./chunk-D8rVyQy1.js";import{U as V}from"./chunk-C-5nnjlW.js";import{X as k}from"./chunk-CL5ipnsT.js";import{E as le}from"./chunk-CA_W5Rkh.js";import{C as P}from"./chunk-BcyGhM7x.js";async function de(){try{const l=await B.get(`${V}faculty`,{withCredentials:!0,headers:{"Content-Type":"application/json"}});return console.log("Faculty Data is: ",l),l.data}catch{console.log("Error: ")}}async function L(l){var m,i;try{return(await B.post(`${V}faculty/approval`,l,{withCredentials:!0,headers:{"Content-Type":"application/json"}})).data}catch(c){return console.error("Error in facultyConformation:",c),{error:!0,message:((i=(m=c==null?void 0:c.response)==null?void 0:m.data)==null?void 0:i.message)||"Something went wrong"}}}Z.register(q,G,H,J,Q,Y,ee,te);const ge=()=>{const[l,m]=o.useState([]),[i,c]=o.useState([]),[s,j]=o.useState(null),[b,y]=o.useState("list"),[S,f]=o.useState(!1),[d,u]=o.useState("pending"),[h,U]=o.useState(null),[v,A]=o.useState("");o.useEffect(()=>{(async()=>{try{const n=await de();if(console.log("Faculty info is: ",n),n){U({name:n.userData.name,event:n.userData.eventType});const g=n.scores.map(r=>({id:r.id||`${Math.random()}`,name:r.id||"Unnamed Event",coordinator:r.coordinator||"Unknown",rounds:r.rounds||[],status:r.status||(r.facultySubmitted?"approved":"pending"),submittedAt:r.submittedAt||r.createdAt||new Date().toISOString(),approvedAt:r.approvedAt||null,rejectedAt:r.rejectedAt||null,feedback:r.feedback||"",participants:r.participants||[],facultySubmitted:r.facultySubmitted||!1,studentSubmitted:r.studentSubmitted||!1})),w=g.filter(r=>r.facultySubmitted===!1),p=g.filter(r=>r.facultySubmitted===!0);m(w),c(p)}}catch(n){console.error("Failed to fetch faculty info:",n)}})()},[]);const E=()=>{j(null),y("list"),A("")},_=a=>{j(a),y("details")},O=()=>{y("chart")},R=async()=>{if(!s)return;console.log("Data Sent to server: ",s);const a={id:s.id,status:"approval"},n=await L(a);console.log("Server Response: ",n),se(s.id,v||"Approved without comments"),m(T()),c(re()),E()},D=async()=>{if(!s)return;console.log("Data Sent to server: ",s);const a={id:s.id,status:"Rejected"},n=await L(a);console.log("Server Response: ",n),ne(s.id,v||"Rejected without specific feedback"),m(T()),E()},I=()=>{if(!s)return null;const a=s.participants,n=a.map(p=>p.name),w=s.rounds.map((p,r)=>{const x=r*137%360,C=`round${r+1}`;return{label:p,data:a.map(z=>z.roundScores[C]||0),backgroundColor:`hsla(${x}, 70%, 60%, 0.5)`,borderColor:`hsl(${x}, 70%, 50%)`,borderWidth:1}});return{labels:n,datasets:w}},N=a=>{const n=new Date(a);return isNaN(n.getTime())?(console.error("Invalid date:",a),"Invalid Date"):n.toLocaleString()},K=()=>{f(!S)},$=()=>{switch(d){case"pending":return l;case"approved":return i;case"all":return[...l,...i];default:return l}},F=s?I():null;return t("div",{className:"min-h-screen bg-gray-900 text-white",children:[e("header",{className:"bg-gray-800 p-4 shadow-lg",children:t("div",{className:"flex justify-between items-center",children:[t("div",{className:"flex items-center space-x-2",children:[b!=="list"?e("button",{onClick:E,className:"text-gray-300 hover:text-white",children:e(W,{className:"w-6 h-6"})}):e("button",{onClick:K,className:"md:hidden text-gray-300 hover:text-white",children:S?e(k,{className:"w-6 h-6"}):e(ae,{className:"w-6 h-6"})}),e("h1",{className:"text-xl sm:text-2xl font-bold",children:"Faculty Dashboard"})]}),t("div",{className:"flex flex-col items-end text-right",children:[e("span",{className:"text-sm font-medium text-white",children:h==null?void 0:h.name}),e("span",{className:"text-xs text-gray-300",children:h==null?void 0:h.event})]})]})}),S&&b==="list"&&e("div",{className:"md:hidden bg-gray-800 border-b border-gray-700",children:t("div",{className:"p-4 flex flex-col space-y-3",children:[t("button",{onClick:()=>{u("pending"),f(!1)},className:`text-left px-4 py-2 rounded ${d==="pending"?"bg-gray-700":"hover:bg-gray-700"}`,children:["Pending Approval (",l.length,")"]}),t("button",{onClick:()=>{u("approved"),f(!1)},className:`text-left px-4 py-2 rounded ${d==="approved"?"bg-gray-700":"hover:bg-gray-700"}`,children:["Approved (",i.length,")"]}),e("button",{onClick:()=>{u("all"),f(!1)},className:`text-left px-4 py-2 rounded ${d==="all"?"bg-gray-700":"hover:bg-gray-700"}`,children:"All Events"})]})}),t("main",{className:"max-w-7xl mx-auto p-3 sm:p-6",children:[b==="list"&&t(M,{children:[t("div",{className:"hidden md:flex mb-6 bg-gray-800 rounded-lg overflow-hidden",children:[t("button",{onClick:()=>u("pending"),className:`px-6 py-3 flex-1 text-center transition-colors ${d==="pending"?"bg-gray-700":"hover:bg-gray-700"}`,children:["Pending Approval (",l.length,")"]}),t("button",{onClick:()=>u("approved"),className:`px-6 py-3 flex-1 text-center transition-colors ${d==="approved"?"bg-gray-700":"hover:bg-gray-700"}`,children:["Approved (",i.length,")"]}),e("button",{onClick:()=>u("all"),className:`px-6 py-3 flex-1 text-center transition-colors ${d==="all"?"bg-gray-700":"hover:bg-gray-700"}`,children:"All Events"})]}),t("div",{className:"space-y-4",children:[t("h2",{className:"text-xl font-bold mb-4",children:[d==="pending"&&"Events Pending Approval",d==="approved"&&"Approved Events",d==="all"&&"All Events"]}),$().length===0?e("div",{className:"bg-gray-800 p-6 rounded-lg text-center",children:e("p",{className:"text-gray-400",children:"No events to display."})}):$().map(a=>e("div",{className:"bg-gray-800 p-4 rounded-lg",children:t("div",{className:"flex flex-col md:flex-row justify-between",children:[t("div",{className:"mb-4 md:mb-0",children:[e("h3",{className:"text-lg font-bold",children:a.name}),t("div",{className:"text-sm text-gray-400 mt-1",children:["Coordinator: ",a.coordinator]}),t("div",{className:"text-sm text-gray-400",children:["Teams: ",a.participants.length]}),t("div",{className:"text-sm text-gray-400",children:["Rounds: ",a.rounds.length]}),t("div",{className:"text-sm text-gray-400",children:["Submitted: ",N(a.submittedAt)]}),a.status==="approved"&&a.approvedAt&&t("div",{className:"text-sm text-green-400",children:["Approved: ",N(a.approvedAt)]}),a.status==="rejected"&&a.rejectedAt&&t("div",{className:"text-sm text-red-400",children:["Rejected: ",N(a.rejectedAt)]})]}),t("div",{className:"flex items-center justify-start md:justify-end space-x-2",children:[e("span",{className:`px-2 py-1 text-xs rounded ${a.status==="approved"?"bg-green-800 text-green-200":a.status==="rejected"?"bg-red-800 text-red-200":"bg-yellow-800 text-yellow-200"}`,children:a.status==="approved"?"Approved":a.status==="rejected"?"Rejected":"Pending"}),a.studentSubmitted?t("button",{onClick:()=>_(a),className:"flex items-center space-x-1 bg-purple-600 hover:bg-purple-700 px-3 py-1 rounded text-sm",children:[e(le,{className:"w-4 h-4"}),console.log("Event at: ",a),e("span",{children:"Review"})]}):e("div",{className:"flex items-center space-x-1 bg-purple-600 hover:bg-purple-700 px-3 py-1 rounded text-sm",children:e("span",{children:"No Submission"})})]})]})},a.id))]})]}),b==="details"&&s&&t("div",{className:"space-y-6",children:[e("div",{className:"bg-gray-800 p-4 rounded-lg",children:t("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center",children:[t("div",{children:[e("h2",{className:"text-xl font-bold",children:s.name}),t("p",{className:"text-gray-400",children:["Coordinator: ",s.coordinator]}),t("p",{className:"text-gray-400",children:["Submitted: ",N(s.submittedAt)]})]}),t("div",{className:"mt-4 md:mt-0 flex space-x-2",children:[e("button",{onClick:O,className:"bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded text-sm",children:"View Chart"}),s.status==="pending"&&t(M,{children:[t("button",{onClick:R,className:"bg-green-600 hover:bg-green-700 px-4 py-2 rounded text-sm flex items-center space-x-1",children:[e(P,{className:"w-4 h-4"}),e("span",{children:"Approve"})]}),t("button",{onClick:D,className:"bg-red-600 hover:bg-red-700 px-4 py-2 rounded text-sm flex items-center space-x-1",children:[e(k,{className:"w-4 h-4"}),e("span",{children:"Reject"})]})]})]})]})}),t("div",{className:"bg-gray-800 p-4 rounded-lg overflow-x-auto",children:[e("h3",{className:"text-lg font-bold mb-4",children:"Participant Scores"}),t("table",{className:"w-full text-sm text-left",children:[e("thead",{className:"text-gray-400 border-b border-gray-700",children:t("tr",{children:[e("th",{className:"py-3 px-4",children:"Team"}),s.rounds.map((a,n)=>e("th",{className:"py-3 px-4",children:a},n)),e("th",{className:"py-3 px-4",children:"Total"}),e("th",{className:"py-3 px-4",children:"Re-Calculated Total"})]})}),e("tbody",{children:s.participants.map(a=>{var g;let n=0;return t("tr",{className:"border-b border-gray-700",children:[e("td",{className:"py-3 px-4 font-medium",children:a.collegeCode}),s.rounds.map((w,p)=>{var C;const r=`round${p+1}`,x=((C=a.roundScores)==null?void 0:C[r])||0;return n+=x,e("td",{className:"py-3 px-4",children:x},r)}),e("td",{className:"py-3 px-4 font-medium",children:((g=a.roundScores)==null?void 0:g.total)||n}),e("td",{className:"py-3 px-4 font-medium",children:n})]},a.id)})})]})]}),s.status==="pending"&&t("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e("h3",{className:"text-lg font-bold mb-3",children:"Review Feedback"}),e("textarea",{value:v,onChange:a=>A(a.target.value),placeholder:"Add comments about these scores (optional)",className:"w-full p-3 rounded bg-gray-700 border border-gray-600 min-h-32 focus:border-purple-500"})]}),s.status!=="pending"&&s.feedback&&t("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e("h3",{className:"text-lg font-bold mb-3",children:"Feedback"}),e("div",{className:"p-3 rounded bg-gray-700 border border-gray-600",children:s.feedback})]})]}),b==="chart"&&s&&t("div",{className:"space-y-6",children:[t("div",{className:"bg-gray-800 p-4 rounded-lg",children:[t("div",{className:"flex justify-between items-center mb-4",children:[t("h2",{className:"text-xl font-bold",children:[s.name," - Score Visualization"]}),e("button",{onClick:()=>y("details"),className:"bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded text-sm",children:"Back to Details"})]}),e("div",{className:"bg-gray-700 p-4 rounded-lg h-96",children:F&&e(X,{data:F,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!0,text:`${s.name} Scores by Round`}},scales:{y:{beginAtZero:!0,max:100}}}})})]}),s.status==="pending"&&t("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e("h3",{className:"text-lg font-bold mb-3",children:"Review Decision"}),t("div",{className:"flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-3",children:[e("textarea",{value:v,onChange:a=>A(a.target.value),placeholder:"Add comments about these scores (optional)",className:"flex-1 p-3 rounded bg-gray-700 border border-gray-600 md:min-h-16 focus:border-purple-500"}),t("div",{className:"flex space-x-2",children:[t("button",{onClick:R,className:"flex-1 bg-green-600 hover:bg-green-700 px-4 py-2 rounded flex items-center justify-center space-x-1",children:[e(P,{className:"w-4 h-4"}),e("span",{children:"Approve"})]}),t("button",{onClick:D,className:"flex-1 bg-red-600 hover:bg-red-700 px-4 py-2 rounded flex items-center justify-center space-x-1",children:[e(k,{className:"w-4 h-4"}),e("span",{children:"Reject"})]})]})]})]})]})]})]})};export{ge as default};
