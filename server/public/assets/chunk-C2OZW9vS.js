import{c as ae,r as y,a as r,j as e,F as q,i as Be}from"./index-Cli15I6T.js";import{g as te}from"./chunk-Dwtk4s3g.js";import{a as se}from"./chunk-D8rVyQy1.js";import{U as le}from"./chunk-CFrYhmIi.js";import{X as _e}from"./chunk-BEm9iFIz.js";import{U as Je}from"./chunk-QgYATuMB.js";import{T as We,U as qe}from"./chunk-Dle-otpl.js";const Ve=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]],Ge=ae("CalendarCheck",Ve);const He=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Ye=ae("ChevronRight",He);const Ke=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Xe=ae("Settings",Ke);function V(l){for(var h=1;h<arguments.length;h++){var c=arguments[h];for(var d in c)l[d]=c[d]}return l}var Qe={read:function(l){return l[0]==='"'&&(l=l.slice(1,-1)),l.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(l){return encodeURIComponent(l).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function re(l,h){function c(i,w,u){if(!(typeof document>"u")){u=V({},h,u),typeof u.expires=="number"&&(u.expires=new Date(Date.now()+u.expires*864e5)),u.expires&&(u.expires=u.expires.toUTCString()),i=encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var g="";for(var N in u)u[N]&&(g+="; "+N,u[N]!==!0&&(g+="="+u[N].split(";")[0]));return document.cookie=i+"="+l.write(w,i)+g}}function d(i){if(!(typeof document>"u"||arguments.length&&!i)){for(var w=document.cookie?document.cookie.split("; "):[],u={},g=0;g<w.length;g++){var N=w[g].split("="),v=N.slice(1).join("=");try{var m=decodeURIComponent(N[0]);if(u[m]=l.read(v,m),i===m)break}catch{}}return i?u[i]:u}}return Object.create({set:c,get:d,remove:function(i,w){c(i,"",V({},w,{expires:-1}))},withAttributes:function(i){return re(this.converter,V({},this.attributes,i))},withConverter:function(i){return re(V({},this.converter,i),this.attributes)}},{attributes:{value:Object.freeze(h)},converter:{value:Object.freeze(l)}})}var _=re(Qe,{path:"/"});const Ze=async()=>{let l=null;try{const h=_.get("userInfo"),c=await se.get(`${le}userRout/updateUserInfo`,{withCredentials:!0,headers:{"Content-Type":"application/json"}});if(console.log("Response is: ",c),!h&&c.status===200){console.log("Expires AT: ",c.data);const d={userCount:c.data.userID||"",college:c.data.collegeName,email:c.data.emailID,name:c.data.name,phone:c.data.phoneNo,events:c.data.events};console.log("Cookie data to be stored: ",d),l=d,Ee(d,c.data.expiresAt)}else{if(c.status!==200)return null;{const d=_.get("userInfo");console.log("Cookie Data Retrieved: ",d),l=d?JSON.parse(d):null}}}catch(h){console.error("Error fetching user profile:",h)}return l};function Ee(l,h){const i=(new Date(h)-new Date)/(1e3*60*60);_.set("userInfo",JSON.stringify(l),{expires:i>0?i/24:1,path:"/"})}async function Ie(l){try{let h={};l.phone&&(h.phoneNo=l.phone),l.name&&(h.name=l.name),l.college&&(h.collegeName=l.college);let c=_.get("userInfo")?JSON.parse(_.get("userInfo")):{};console.log("Current cookie data: ",c);const d=await se.post(`${le}userRout/updateUserInfo`,h,{withCredentials:!0,headers:{"Content-Type":"application/json"}});if(d.status===200){l.phone&&(c.phone=l.phone),l.name&&(c.name=l.name),l.college&&(c.college=l.college);const i=c.expiresAt?new Date(c.expiresAt):new Date(Date.now()+24*60*60*1e3);Ee(c,i)}return d}catch(h){return console.error("Error updating user information: ",h),null}}const Ce=async(l,h,c)=>{const i={paymentMethod:h?"cash":"online",eventsValues:l,isContingentSelection:c};return(await se.post(`${le}payment/orders`,i,{withCredentials:!0,headers:{"Content-Type":"application/json"}})).data},O=l=>Object.values(l).flat(),et=({userProfile:l,onUpdateProfile:h})=>{const[c,d]=y.useState([]),[i,w]=y.useState([]),[u,g]=y.useState({}),[N,v]=y.useState({}),[m,b]=y.useState({}),[C,k]=y.useState(null),[D,$]=y.useState(!1),[T,A]=y.useState(!1),[G,ne]=y.useState(!1),[ke,H]=y.useState(!1),[F,Se]=y.useState(null),[J,oe]=y.useState(null),[S,ie]=y.useState({phone:l.phone||"",college:l.college||""}),[P,Pe]=y.useState({Technical:[],Cultural:[],Gaming:[]}),[De,M]=y.useState({}),[U,Y]=y.useState(!1);y.useEffect(()=>{(async()=>{try{const[a,s,n]=await Promise.all([te("technical"),te("gaming"),te("cultural")]);Pe({Technical:a||[],Cultural:n||[],Gaming:s||[]})}catch(a){console.error("Error fetching event categories:",a)}})()},[]);const je=(t,a,s)=>{d(n=>n.includes(t)?n.filter(o=>o!==t):[...n,t]),w(n=>n.some(o=>o.eventId===t)?n.filter(o=>o.eventId!==t):[...n,{eventId:t,amount:a,max:s}]),Y(!1)},Te=()=>{const t=O(P).filter(o=>o.eventID).map(o=>({eventId:o.eventID,amount:o.registrationFee,max:o.maximumNoOfParticipants}));d(t.map(o=>o.eventId)),w(t);const a={},s={},n={};t.forEach(o=>{const f=o.eventId,p=`Team 1-${f}`;a[f]=[p],s[f]={[p]:!0},n[f]={[p]:[]}}),v(a),b(s),g(n),M(t.reduce((o,f)=>(o[f.eventId]=!1,o),{})),Y(!0),$(!0)},K=t=>{var n;const a=O(P).find(o=>o.eventID===t);return(((n=N[t])==null?void 0:n.length)||0)*((a==null?void 0:a.registrationFee)||0)},X=()=>U?3e3:c.reduce((t,a)=>t+K(a),0),Oe=async(t,a,s=l.name)=>{try{await Ie({phone:t,college:a,name:s})&&h({...l,phone:S.phone,college:S.college,isProfileComplete:!0})}catch(n){console.error("Error submitting new data",n)}},Q=(t,a,s,n,o)=>{g(f=>{const p={...f};return p[t]||(p[t]={}),p[t][a]||(p[t][a]=[]),p[t][a][s]={...p[t][a][s]||{name:"",email:"",phone:"",college:""},[n]:o},p})},$e=(t,a)=>{g(s=>{var n;return{...s,[t]:{...s[t],[a]:[...((n=s[t])==null?void 0:n[a])||[],{name:l.name||"",email:l.email||"",phone:l.phone||"",college:l.college||""}]}}}),M(s=>({...s,[t]:!0}))},Ae=(t,a)=>{var o,f;const s=O(P).find(p=>p.eventID===t);if((((f=(o=u[t])==null?void 0:o[a])==null?void 0:f.length)||0)>=((s==null?void 0:s.maximumNoOfParticipants)||1/0)){alert("Maximum participant limit reached for this team.");return}g(p=>{var E;return{...p,[t]:{...p[t],[a]:[...((E=p[t])==null?void 0:E[a])||[],{name:"",email:"",phone:"",college:l.college||""}]}}})},ce=t=>{v(a=>{var o;const s={...a},n=`Team ${(((o=s[t])==null?void 0:o.length)||0)+1}-${t}`;return s[t]=[...s[t]||[],n],s}),b(a=>{var s;return{...a,[t]:{...a[t],[`Team ${(((s=N[t])==null?void 0:s.length)||0)+1}-${t}`]:!0}}})},Ue=(t,a,s)=>{g(n=>{var p;const o={...n};if(!((p=o[t])!=null&&p[a]))return o;const f=o[t][a][s];return o[t][a]=o[t][a].filter((E,x)=>x!==s),(f==null?void 0:f.email)===l.email&&M(E=>({...E,[t]:!1})),o})},Fe=(t,a)=>{v(s=>{var o;const n={...s};return n[t]=((o=n[t])==null?void 0:o.filter(f=>f!==a))||[],n}),g(s=>{var o;const n={...s};if((o=n[t])!=null&&o[a]){const f=n[t][a].some(p=>p.email===l.email);delete n[t][a],f&&M(p=>({...p,[t]:!1}))}return n}),b(s=>{var o;const n={...s};return(o=n[t])!=null&&o[a]&&delete n[t][a],n})},Me=(t,a)=>{var n,o;const s=((n=m[t])==null?void 0:n[a])??!0;if(s){const f=((o=u[t])==null?void 0:o[a])||[];if(f.some(E=>!E.name||!E.email||!E.phone)&&f.length>0){alert("Please fill all participant details before saving");return}}b(f=>({...f,[t]:{...f[t],[a]:!s}}))},Z=()=>c.every(t=>{var a;return(a=N[t])==null?void 0:a.every(s=>{var n;return!(((n=m[t])==null?void 0:n[s])??!0)})}),de=()=>c.filter(t=>{var a;return(a=N[t])==null?void 0:a.some(s=>{var n;return((n=m[t])==null?void 0:n[s])??!0})}).map(t=>{var a;return((a=O(P).find(s=>s.eventID===t))==null?void 0:a.eventName)||t}),Le=()=>{const t=de();if(t.length>0){alert(`Please save all team details for these events:
- ${t.join(`
- `)}`);return}ne(!0)},me=async(t=!1)=>{try{if(t){const a=await Ce(u,!0,U);oe("Pay at Desk"),ue("Pay at Desk"),window.location.href="/success"}else{H(!0);const a=await Ce(u,!1,U);Se({orderNo:a.orderNo,amount:X()}),oe("Online"),H(!1)}}catch{alert("Error processing payment"),H(!1)}},Re=()=>{ue("Online"),window.open("https://rzp.io/rzp/p7M1d5o","_blank")},pe=t=>{navigator.clipboard.writeText(t).then(()=>alert(`Copied: ${t}`))},ue=t=>{const a=c.map((o,f)=>{const p=O(P).find(E=>E.eventID===o);return{id:`${o}-${Date.now()}-${f}`,name:p==null?void 0:p.eventName,registrationDate:new Date().toLocaleDateString(),participants:u[o]||{},teams:N[o]||[],paymentMethod:t}}),n=[...JSON.parse(localStorage.getItem("registeredEvents")||"[]"),...a];localStorage.setItem("registeredEvents",JSON.stringify(n)),h({...l,registeredEvents:n}),d([]),w([]),g({}),v({}),b({}),M({}),Y(!1)},ze=t=>t.length>20?`${t.substring(0,17)}...`:t;return l.isProfileComplete?G?r("div",{className:"max-w-4xl mx-auto p-4 sm:p-6 bg-gray-800 rounded-lg shadow-lg text-white",children:[e("h2",{className:"text-xl sm:text-2xl font-bold mb-6 text-center underline",children:"Order Summary"}),r("div",{className:"grid grid-cols-1 gap-6",children:[r("div",{children:[e("h3",{className:"text-lg sm:text-xl font-semibold text-center mb-2",children:"User Information"}),e("div",{className:"bg-gray-700 p-4 rounded",children:r("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[r("p",{children:[e("span",{className:"font-medium",children:"Name:"})," ",l.name]}),r("p",{children:[e("span",{className:"font-medium",children:"Email:"})," ",l.email]}),r("p",{children:[e("span",{className:"font-medium",children:"Phone:"})," ",l.phone]}),r("p",{children:[e("span",{className:"font-medium",children:"College:"})," ",l.college]})]})})]}),r("div",{children:[e("h3",{className:"text-lg sm:text-xl font-semibold text-center mb-2",children:"Selected Events"}),e("div",{className:"space-y-4",children:c.map((t,a)=>{var p,E;const s=O(P).find(x=>x.eventID===t),n=((p=N[t])==null?void 0:p.length)||0,o=K(t),f=Object.values(u[t]||{}).flat().length;return r("div",{className:"bg-gray-700 p-4 rounded",children:[r("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-2",children:[e("h4",{className:"text-base sm:text-lg font-medium",children:s==null?void 0:s.eventName}),r("div",{className:"flex items-center gap-2 text-sm sm:text-base",children:[J&&e("span",{className:"bg-purple-600 text-white px-2 py-1 rounded",children:J}),r("span",{className:"bg-purple-600 text-white px-2 py-1 rounded",children:[f," Participant",f!==1?"s":""]})]})]}),r("div",{className:"text-sm text-gray-300 grid grid-cols-1 sm:grid-cols-2 gap-2",children:[r("p",{children:["Teams: ",n]}),r("p",{children:["Total: ₹",s==null?void 0:s.registrationFee," × ",n," = ₹",o]})]}),r("div",{className:"mt-4",children:[e("h4",{className:"text-base sm:text-lg font-medium mb-2",children:"Participants Details"}),e("div",{className:"space-y-4",children:(E=N[t])==null?void 0:E.map((x,I)=>{var L,R;return r("div",{children:[r("h5",{className:"text-sm sm:text-md font-semibold mb-2",children:["Team: ",x.split("-")[0]]}),e("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:(R=(L=u[t])==null?void 0:L[x])==null?void 0:R.map((j,W)=>r("div",{className:"mb-2 bg-gray-800 p-3 rounded",children:[e("p",{children:j.name}),e("p",{className:"truncate",title:j.email,children:ze(j.email)}),e("p",{children:j.phone}),e("p",{children:j.college})]},`${x}-${W}`))})]},`${x}-${I}`)})})]})]},`${t}-${a}`)})})]}),e("div",{className:"bg-gray-700 p-4 rounded",children:r("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center text-base sm:text-lg font-bold gap-2",children:[e("span",{children:"Total Amount:"}),r("span",{className:"text-purple-400",children:["₹",X()," ",U&&"(Contingent Discount Applied)"]})]})}),r("div",{className:"flex flex-col sm:flex-row justify-center gap-3",children:[e("button",{onClick:()=>A(!0),className:"bg-purple-600 text-white px-6 py-3 rounded hover:bg-purple-700 transition-colors w-full sm:w-auto",disabled:J!==null,children:"Proceed to Payment"}),e("button",{onClick:()=>ne(!1),className:"bg-gray-600 text-white px-6 py-2 rounded hover:bg-gray-700 transition-colors w-full sm:w-auto",children:"Back to Events"})]})]}),T&&e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:r("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md",children:[r("div",{className:"flex items-center justify-between mb-4",children:[e("h2",{className:"text-xl font-bold text-center flex-1",children:"Choose Payment Method"}),e("button",{onClick:()=>A(!1),className:"text-white hover:text-purple-400 transition-colors",children:e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r("div",{className:"space-y-4",children:[ke?r("div",{className:"text-center py-8",children:[r("svg",{className:"animate-spin h-8 w-8 text-purple-500 mx-auto mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e("p",{children:"Generating your order ID..."})]}):F&&J==="Online"?r("div",{className:"space-y-4",children:[r("p",{className:"text-center text-sm text-gray-300",children:["Please enter the ",e("span",{className:"font-bold",children:"order no"})," and"," ",e("span",{className:"font-bold",children:"total amount"})," correctly in the payment page"]}),r("div",{className:"flex justify-between items-center bg-gray-700 p-3 rounded",children:[e("span",{className:"font-medium",children:"Order Number:"}),r("div",{className:"flex items-center gap-2",children:[e("span",{children:F.orderNo}),e("button",{onClick:()=>pe(F.orderNo.toString()),className:"text-purple-400 hover:text-purple-500 transition-colors",children:e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]})]}),r("div",{className:"flex justify-between items-center bg-gray-700 p-3 rounded",children:[e("span",{className:"font-medium",children:"Total Amount:"}),r("div",{className:"flex items-center gap-2",children:[r("span",{children:["₹",F.amount]}),e("button",{onClick:()=>pe(`₹${F.amount}`),className:"text-purple-400 hover:text-purple-500 transition-colors",children:e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]})]}),e("button",{onClick:Re,className:"w-full bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition-colors",children:"Proceed to Payment"}),e("p",{className:"text-center text-sm text-gray-300",children:"Please take a screenshot of the payment for future reference"})]}):r(q,{children:[e("button",{onClick:()=>me(!1),className:"w-full bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition-colors",children:"Pay Online"}),e("button",{onClick:()=>me(!0),className:"w-full bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors",children:"Pay at Desk"})]}),e("button",{onClick:()=>A(!1),className:"w-full bg-gray-600 text-white px-6 py-3 rounded-lg hover:bg-gray-700 transition-colors",children:"Cancel"})]})]})})]}):r("div",{className:"text-white p-4 sm:p-6",children:[r("div",{className:"flex items-center justify-start mb-8",children:[D&&e("button",{onClick:()=>$(!1),className:"text-white hover:text-purple-400 transition-colors mr-2",children:e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),e("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-center",children:D?"PARTICIPANT DETAILS":"SELECT EVENTS"})]}),D?c.length>0&&r(q,{children:[e("div",{className:"space-y-6",children:c.map(t=>{var o,f,p,E;const a=(o=O(P))==null?void 0:o.find(x=>x.eventID===t),s=((f=N[t])==null?void 0:f.length)||0,n=K(t);return(p=N[t])!=null&&p.length||ce(t),r("div",{className:"p-4 border border-gray-700 rounded bg-gray-700",children:[r("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-2",children:[e("h2",{className:"text-lg sm:text-xl font-bold",children:a==null?void 0:a.eventName}),r("div",{className:"text-purple-400 font-semibold text-sm sm:text-base",children:["Total: ₹",n," (",s," teams × ₹",a==null?void 0:a.registrationFee,")"]})]}),e("div",{className:"space-y-4",children:(E=N[t])==null?void 0:E.map((x,I)=>{var L,R,j,W,he,ge,fe,xe,be;return r("div",{children:[e("h3",{className:"text-base sm:text-lg font-bold",children:x.split("-")[0]}),r("div",{className:"space-y-4 mt-2",children:[(R=(L=u[t])==null?void 0:L[x])==null?void 0:R.map((ee,z)=>{var ye,Ne,ve,we;return r("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e("input",{type:"text",placeholder:"Co-participant Name",className:"w-full p-2 rounded bg-gray-800 text-white border border-gray-600 focus:border-purple-500 focus:ring-1 focus:ring-purple-500",value:ee.name,onChange:B=>Q(t,x,z,"name",B.target.value),disabled:!(((ye=m[t])==null?void 0:ye[x])??!0)}),e("input",{type:"email",placeholder:"Email",className:"w-full p-2 rounded bg-gray-800 text-white border border-gray-600 focus:border-purple-500 focus:ring-1 focus:ring-purple-500",value:ee.email,onChange:B=>Q(t,x,z,"email",B.target.value.toLowerCase()),disabled:!(((Ne=m[t])==null?void 0:Ne[x])??!0)}),e("input",{type:"tel",placeholder:"Phone Number",className:"w-full p-2 rounded bg-gray-800 text-white border border-gray-600 focus:border-purple-500 focus:ring-1 focus:ring-purple-500",value:ee.phone,onChange:B=>Q(t,x,z,"phone",B.target.value.replace(/\D/g,"").slice(0,10)),disabled:!(((ve=m[t])==null?void 0:ve[x])??!0)}),(((we=m[t])==null?void 0:we[x])??!0)&&e("button",{onClick:()=>Ue(t,x,z),className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition-colors w-full md:w-auto",children:"Delete"})]},`${x}-${z}`)}),r("div",{className:"flex flex-wrap gap-2",children:[(((j=m[t])==null?void 0:j[x])??!0)&&r(q,{children:[e("button",{onClick:()=>Ae(t,x),className:"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 transition-colors",disabled:(((he=(W=u[t])==null?void 0:W[x])==null?void 0:he.length)||0)>=((a==null?void 0:a.maximumNoOfParticipants)||1/0),children:"Add Participant"}),!De[t]&&e("button",{onClick:()=>$e(t,x),className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition-colors",disabled:(((fe=(ge=u[t])==null?void 0:ge[x])==null?void 0:fe.length)||0)>=((a==null?void 0:a.maximumNoOfParticipants)||1/0),children:"Add Me"}),!U&&e("button",{onClick:()=>Fe(t,x),className:"bg-red-600 text-white px-4 py-2 rounded transition-colors",children:"Delete Team"})]}),e("button",{onClick:()=>Me(t,x),className:`${((xe=m[t])==null?void 0:xe[x])??!0?"bg-yellow-600 hover:bg-yellow-700":"bg-blue-600 hover:bg-blue-700"} text-white px-4 py-2 rounded transition-colors`,children:((be=m[t])==null?void 0:be[x])??!0?"Save":"Edit"})]})]})]},`${x}-${I}`)})}),e("div",{className:"flex flex-wrap gap-2 mt-4",children:e("button",{onClick:()=>ce(t),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition-colors",children:"Add Team"})})]},t)})}),e("div",{className:"bg-gray-800 p-4 rounded-lg my-6",children:r("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center text-base sm:text-lg font-bold gap-2",children:[e("span",{children:"Total Amount:"}),r("span",{className:"text-purple-400",children:["₹",X()," ",U&&"(Contingent Discount Applied)"]})]})}),r("div",{className:"flex flex-col sm:flex-row justify-center gap-4 mt-8",children:[e("button",{onClick:()=>$(!1),className:"bg-gray-600 text-white px-6 py-2 rounded hover:bg-gray-700 transition-colors w-full sm:w-auto",children:"Back"}),e("button",{onClick:Le,className:`${Z()?"bg-purple-600 hover:bg-purple-700":"bg-purple-400 cursor-not-allowed"} text-white px-6 py-2 rounded transition-colors w-full sm:w-auto`,disabled:!Z(),children:"Submit"})]}),!Z()&&r("div",{className:"mt-4 p-3 bg-yellow-900 text-yellow-200 rounded text-center",children:[e("p",{children:"Please save all teams before submitting."}),r("p",{className:"font-semibold mt-1",children:["Unsaved events: ",de().join(", ")]})]})]}):r(q,{children:[e("div",{className:"mb-6 flex justify-center",children:e("button",{onClick:Te,className:"bg-green-600 text-white px-6 py-3 rounded hover:bg-green-700 transition-colors w-full sm:w-auto",children:"Register for All Events (Contingent)"})}),e("div",{className:"space-y-6",children:Object.keys(P).map(t=>{var a;return r("div",{children:[r("button",{className:"w-full text-left text-lg sm:text-xl font-bold p-3 bg-gray-700 rounded hover:bg-gray-600 transition-colors",onClick:()=>k(C===t?null:t),children:[t," ",C===t?"-":"+"]}),C===t&&((a=P[t])==null?void 0:a.length)>0&&e("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 mt-4",children:P[t].map(s=>r("div",{className:`cursor-pointer transition-all duration-300 flex flex-col items-center p-4 rounded ${c.includes(s.eventID)?"ring-4 ring-purple-500 bg-gray-700":"bg-gray-700 hover:bg-gray-600"}`,onClick:()=>je(s.eventID,s.registrationFee,s.maximumNoOfParticipants),children:[e("img",{src:s.img||"",alt:s.eventName,className:"w-24 h-24 sm:w-32 sm:h-32 object-cover rounded"}),e("h3",{className:"text-center mt-2 text-sm sm:text-lg",children:s.eventName}),r("p",{className:"text-purple-400 mt-1 text-sm sm:text-base",children:["₹",s.registrationFee]})]},s.eventID))})]},t)})}),c.length>0&&e("button",{onClick:()=>$(!0),className:"bg-purple-600 text-white px-6 py-2 rounded block mx-auto mt-6 hover:bg-purple-700 transition-colors w-full sm:w-auto",children:"Next"})]})]}):r("div",{className:"max-w-md mx-auto p-4",children:[e("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Complete Your Profile"}),r("div",{className:"bg-gray-700 rounded-lg p-6 space-y-4",children:[e("p",{className:"text-gray-300 mb-4",children:"Please complete your profile information before registering for events."}),r("div",{className:"space-y-4",children:[r("div",{children:[e("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Phone Number"}),e("input",{type:"tel",value:S.phone,onChange:t=>ie({...S,phone:t.target.value.replace(/\D/g,"").slice(0,10)}),className:"w-full p-2 rounded bg-gray-800 border border-gray-600 focus:border-purple-500 focus:ring-1 focus:ring-purple-500",required:!0})]}),r("div",{children:[e("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"College Name"}),e("input",{type:"text",value:S.college,onChange:t=>ie({...S,college:t.target.value.replace(/\b\w/g,a=>a.toUpperCase())}),className:"w-full p-2 rounded bg-gray-800 border border-gray-600 focus:border-purple-500 focus:ring-1 focus:ring-purple-500",required:!0})]}),e("button",{onClick:()=>{S.phone&&S.college&&Oe(S.phone,S.college)},className:"w-full bg-purple-600 text-white px-6 py-2 rounded hover:bg-purple-700 transition-colors",disabled:!S.phone||!S.college,children:"Save Profile"})]})]})]})},tt=({userProfile:l})=>{const[h,c]=y.useState([]),[d,i]=y.useState(!0),[w,u]=y.useState(null);return y.useEffect(()=>{(async()=>{var N;try{i(!0),console.log("Fetching events...");const m=(await getUsersEventInfo()).data;if(console.log("Server data:",m),Array.isArray(m)&&m.length>0){c(m),console.log("Set userEvents:",m),localStorage.setItem("registeredEvents",JSON.stringify(m));return}const b=localStorage.getItem("registeredEvents");if(b){const k=JSON.parse(b);console.log("Local storage data:",k),c(k);try{await saveUserEvents(k)}catch(D){console.warn("Failed to sync events to backend",D)}return}const C=((N=l.registeredEvents)==null?void 0:N.filter(k=>k.id))||[];console.log("Profile events:",C),c(C),localStorage.setItem("registeredEvents",JSON.stringify(C));try{await saveUserEvents(C)}catch(k){console.warn("Failed to sync events to backend",k)}}catch(v){console.error("Error loading events:",v),u("Failed to load events. Please try again later.")}finally{i(!1)}})()},[l]),y.useEffect(()=>{console.log("Current userEvents state:",h)},[h]),d?e("div",{className:"flex items-center justify-center min-h-[200px]",children:e("div",{className:"text-gray-400 text-lg",children:"Loading your events..."})}):w?e("div",{className:"flex items-center justify-center min-h-[200px]",children:e("div",{className:"text-red-500 text-lg",children:w})}):r("div",{className:"container mx-auto px-4 py-6",children:[e("h2",{className:"text-2xl md:text-3xl font-bold mb-6 text-white",children:"Your Registered Events"}),h.length===0?r("div",{className:"bg-gray-900 rounded-lg p-8 text-center",children:[e("h3",{className:"text-xl font-semibold text-gray-400 mb-2",children:"No Events Registered Yet"}),e("p",{className:"text-gray-500",children:"Register for events to see them here."})]}):e("div",{className:"grid gap-6",children:h.map((g,N)=>{console.log(`Event ${N}:`,g);const v=g.participantsNotEntered&&Object.keys(g.participantsNotEntered).length>0;return e("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg",children:v?Object.entries(g.participantsNotEntered).map(([m,b])=>r("div",{className:"mb-6 last:mb-0",children:[e("h3",{className:"text-xl font-semibold text-white mb-4",children:m}),Object.entries(b).map(([C,k])=>r("div",{className:"mb-4 last:mb-0",children:[r("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-4",children:[e("h4",{className:"text-lg font-medium text-purple-300 mb-2 md:mb-0",children:C}),r("div",{className:"flex flex-wrap gap-2",children:[r("span",{className:"bg-purple-600 px-3 py-1 rounded-full text-sm",children:[k.length," Participants"]}),g.paymentMethod&&e("span",{className:"bg-blue-600 px-3 py-1 rounded-full text-sm",children:g.paymentMethod==="online"?"Online":"Cash"}),r("span",{className:"bg-gray-600 px-3 py-1 rounded-full text-sm",children:["Team Code: ",`KA_${g.orderNo}_${C.split(/[\s-]+/)[1]}`]})]})]}),e("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-3",children:k.map((D,$)=>{var A;console.log("user data: ",g.participants);const T=(A=g.participants)==null?void 0:A.find(G=>G.emailID===D);return e("div",{className:"bg-gray-700 p-4 rounded-lg",children:T?r("div",{className:"space-y-2",children:[e("p",{className:"font-medium text-white truncate",children:T.name}),r("div",{className:"text-gray-300 text-sm space-y-1",children:[e("p",{className:"truncate",children:T.emailID}),e("p",{children:T.phoneNo||"No phone provided"}),e("p",{children:T.collegeName||"No college info"})]})]}):r("p",{className:"text-gray-400 text-sm",children:["No matching participant for email: ",D]})},$)})})]},C))]},m)):r("div",{className:"text-gray-400",children:["No participant data available for this event (Order No: ",g.orderNo||"N/A",")."]})},g.orderNo||N)})})]})},rt=({profile:l,onSave:h,onClose:c})=>{const[d,i]=y.useState(l),[w,u]=y.useState(l.name),g=()=>{const v=Math.random().toString();u(v),i(m=>({...m,avatar:`https://api.dicebear.com/7.x/adventurer/svg?seed=${v}`}))};return e("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r("div",{className:"bg-gray-800 rounded-lg p-4 sm:p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[r("div",{className:"flex justify-between items-center mb-4 sm:mb-6",children:[e("h2",{className:"text-lg sm:text-xl font-bold",children:"Edit Profile"}),e("button",{onClick:c,className:"text-gray-400 hover:text-white",children:e(_e,{className:"w-5 h-5 sm:w-6 sm:h-6"})})]}),r("form",{onSubmit:v=>{v.preventDefault(),h({...d,avatar:`https://api.dicebear.com/7.x/adventurer/svg?seed=${w}`})},className:"space-y-3 sm:space-y-4",children:[e("div",{className:"flex justify-center mb-4 sm:mb-6",children:r("div",{className:"relative group",children:[e("img",{src:`https://api.dicebear.com/7.x/adventurer/svg?seed=${w}`,alt:"Profile",className:"w-20 h-20 sm:w-24 sm:h-24 rounded-full border-4 border-purple-500"}),e("button",{type:"button",onClick:g,className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:e(Je,{className:"w-5 h-5 sm:w-6 sm:h-6"})})]})}),r("div",{children:[e("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Full Name"}),e("input",{type:"text",value:d.name,onChange:v=>{i({...d,name:v.target.value}),u(v.target.value)},className:"w-full p-2 rounded bg-gray-700 border border-gray-600 focus:border-purple-500 focus:ring-1 focus:ring-purple-500 text-sm sm:text-base",required:!0})]}),r("div",{children:[e("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Email"}),e("input",{type:"email",value:d.email,readOnly:!0,className:"w-full p-2 rounded bg-gray-700 border border-gray-600 opacity-75 cursor-not-allowed text-sm sm:text-base"}),e("p",{className:"text-xs text-gray-400 mt-1",children:"Email cannot be changed"})]}),r("div",{children:[e("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Phone Number"}),e("input",{type:"tel",value:d.phone,onChange:v=>i({...d,phone:v.target.value}),className:"w-full p-2 rounded bg-gray-700 border border-gray-600 focus:border-purple-500 focus:ring-1 focus:ring-purple-500 text-sm sm:text-base",required:!0})]}),r("div",{children:[e("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"College Name"}),e("input",{type:"text",value:d.college,onChange:v=>i({...d,college:v.target.value}),className:"w-full p-2 rounded bg-gray-700 border border-gray-600 focus:border-purple-500 focus:ring-1 focus:ring-purple-500 text-sm sm:text-base",required:!0})]}),r("div",{className:"flex justify-end space-x-2 sm:space-x-3 mt-4 sm:mt-6",children:[e("button",{type:"button",onClick:c,className:"px-3 py-1.5 sm:px-4 sm:py-2 rounded text-sm sm:text-base bg-gray-700 hover:bg-gray-600 transition-colors",children:"Cancel"}),e("button",{onClick:()=>{profileForm.phone&&profileForm.college&&onUpdateProfile({...userProfile,phone:profileForm.phone,college:profileForm.college,isProfileComplete:!0})},className:"w-full bg-purple-600 text-white px-6 py-2 rounded hover:bg-purple-700 transition-colors",children:"Save Profile"})]})]})]})})},dt=()=>{const[l,h]=y.useState("profile"),[c,d]=y.useState(!1),[i,w]=y.useState(null),[u,g]=y.useState(!0);y.useEffect(()=>{(async()=>{try{g(!0);const b=await Ze();if(console.log("ParticipantDashboard - Fetched UserInfo:",b),b){const C={name:b.name||"",email:b.email||"",phone:b.phone||"",college:b.college||"",avatar:`https://api.dicebear.com/7.x/adventurer/svg?seed=${b.name||"default"}`,isProfileComplete:!!(b.college&&b.phone),registeredEvents:b.events||[]};console.log("ParticipantDashboard - Set UserProfile:",C),w(C)}else console.log("ParticipantDashboard - No user info fetched, setting profile to null"),w(null)}catch(b){console.error("ParticipantDashboard - Error fetching user profile:",b),w(null)}finally{g(!1)}})()},[]);const N=m=>{i&&w(b=>{const C=b?{...b,...m}:null;return console.log("ParticipantDashboard - Updated UserProfile:",C),C}),d(!1)},v={profile:{title:"Profile & Registration",icon:qe,component:i?e(et,{userProfile:i,onUpdateProfile:N}):e("p",{className:"text-center p-8",children:"Please sign in to access your profile..."})},summary:{title:"Event Summary",icon:Ge,component:i?e(tt,{userProfile:i}):e("p",{className:"text-center p-8",children:"Sign in to view your event summary..."})}};return u?e("div",{className:"min-h-screen bg-gray-900 text-white flex items-center justify-center",children:r("div",{className:"text-center",children:[e("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500 mx-auto mb-4"}),e("p",{className:"text-lg",children:"Loading your dashboard..."})]})}):r("div",{className:"min-h-screen bg-gray-900 text-white",children:[e("header",{className:"bg-gray-800 p-4 shadow-lg",children:r("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[r("div",{className:"flex items-center space-x-4",children:[e("h1",{className:"text-2xl font-bold",children:"Event Dashboard"}),r(Be,{to:"/scoreboard",className:"hidden md:flex items-center space-x-2 text-purple-400 hover:text-purple-300",children:[e(We,{className:"w-5 h-5"}),e("span",{children:"Scoreboard"})]})]}),i&&r("div",{className:"flex items-center space-x-4",children:[e("span",{className:"hidden md:inline font-medium",children:i.name}),e("span",{className:"hidden md:inline text-gray-300",children:i.email}),r("button",{onClick:()=>d(!0),className:"relative group",children:[e("img",{src:i.avatar,alt:i.name,className:"w-10 h-10 rounded-full border-2 border-purple-500 transition-transform group-hover:scale-105"}),e("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e(Xe,{className:"w-5 h-5 text-white"})})]})]})]})}),c&&i&&e(rt,{profile:i,onSave:N,onClose:()=>d(!1)}),e("div",{className:"max-w-7xl mx-auto p-4 md:p-6 lg:p-8",children:r("div",{className:"grid md:grid-cols-[250px,1fr] gap-6",children:[e("div",{className:"space-y-2",children:Object.entries(v).map(([m,b])=>r("button",{onClick:()=>h(m),disabled:m!=="profile"&&(!i||!i.isProfileComplete),className:`w-full flex items-center justify-between p-4 rounded-lg transition-colors ${l===m?"bg-purple-600 text-white":m!=="profile"&&(!i||!i.isProfileComplete)?"bg-gray-700 opacity-50 cursor-not-allowed":"bg-gray-800 hover:bg-gray-700"}`,children:[r("div",{className:"flex items-center space-x-3",children:[e(b.icon,{className:"w-5 h-5"}),e("span",{children:b.title})]}),e(Ye,{className:"w-4 h-4"})]},m))}),e("div",{className:"bg-gray-800 rounded-lg p-0",children:v[l].component})]})})]})};export{dt as default};
